<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NASA Space Probes - Interactive Experience</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300&family=IBM+Plex+Sans+KR:wght@200;300;400;500;600&family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --font-header: 'Syncopate', sans-serif;       
            --font-ui: 'Chakra Petch', sans-serif;        
            --font-body: 'IBM Plex Sans KR', sans-serif;  
            --font-data: 'Space Mono', monospace;         
        }

        body { 
            font-family: var(--font-body); 
            overflow: hidden; 
            background: radial-gradient(ellipse at bottom, #0F1215 0%, #000000 100%);
            color: #e5e5e5;
            margin: 0;
            overscroll-behavior: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: none; 
        }

        .font-header-sci { font-family: var(--font-header); letter-spacing: -0.02em; text-transform: uppercase; }
        .font-ui-sci { font-family: var(--font-ui); letter-spacing: 0.05em; }
        .font-body-sci { font-family: var(--font-body); letter-spacing: -0.01em; line-height: 1.7; }
        .font-terminal { font-family: var(--font-data); letter-spacing: -0.05em; }
        
        .allow-scroll { touch-action: pan-y; -webkit-overflow-scrolling: touch; }
        .custom-scrollbar::-webkit-scrollbar { width: 3px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #f97316; }

        @keyframes animStar { from { transform: translateX(-2500px); } to { transform: translateX(2500px); } }
        @keyframes moveLaser { 0% { top: 0; opacity: 1; box-shadow: 0 0 5px #f97316; } 50% { opacity: 1; box-shadow: 0 0 20px #f97316, 0 0 10px white; } 100% { top: 100%; opacity: 0; } }
        @keyframes revealImage { 0% { clip-path: inset(0 0 100% 0); opacity: 0.5; } 100% { clip-path: inset(0 0 0 0); opacity: 1; } }
        @keyframes popupUp { 0% { transform: translateY(100px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } }

        .scan-active .scannable-image { clip-path: inset(0 0 100% 0); animation: revealImage 2.5s cubic-bezier(0.19, 1, 0.22, 1) forwards; animation-delay: 0.5s; }
        .scan-active .laser-beam { position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: #fff; z-index: 20; opacity: 0; animation: moveLaser 2.5s cubic-bezier(0.19, 1, 0.22, 1) forwards; animation-delay: 0.5s; }
        
        .page-transition { transition: transform 1s cubic-bezier(0.65, 0, 0.35, 1); }
        .popup-card-visible { animation: popupUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        .content-transition { transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1), opacity 0.6s ease; }
        .slide-up-out { transform: translateY(-80px) scale(0.98); opacity: 0; filter: blur(5px); }
        .slide-up-in { transform: translateY(80px) scale(0.98); opacity: 0; filter: blur(5px); }
        .slide-down-out { transform: translateY(80px) scale(0.98); opacity: 0; filter: blur(5px); }
        .slide-down-in { transform: translateY(-80px) scale(0.98); opacity: 0; filter: blur(5px); }
        .slide-active { transform: translateY(0) scale(1); opacity: 1; filter: blur(0); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

// --- Updated Probes Data (Sorted Chronologically & Standardized Specs) ---
        const probesData = [
          { 
            id: 'pioneer', 
            index: '01', 
            name: 'Pioneer 10', 
            year: '1972', 
            mission: 'Jupiter & Solar Escape', 
            description: '인류 최초로 위험한 소행성대를 통과하고 목성을 근접 탐사하여 외행성 탐사의 가능성을 증명한 기념비적인 우주선입니다. 이 탐사선은 태양계를 벗어나는 궤도에 진입한 최초의 인공물로서 외계 지적 생명체에게 보내는 메시지가 담긴 금속판을 품은 채, 2003년 마지막 교신을 끝으로 현재 황소자리의 알데바란을 향해 영원한 항해를 지속하고 있습니다.', 
            image: 'pic/pioneer_a.png', 
            specs: [{ label: 'STATUS', value: 'LOST SIGNAL' }, { label: 'LAUNCH', value: '1972.03.02' }, { label: 'LOC', value: '133.04 AU' }], 
            gallery: ['pic/pioneer_1.png', 'pic/pioneer_2.png', 'pic/pioneer_3.png', 'pic/pioneer_4.png', 'pic/pioneer_5.png'] 
          },
          { 
            id: 'viking', 
            index: '02', 
            name: 'Viking 1', 
            year: '1975', 
            mission: 'Mars Landing', 
            description: '붉은 행성, 화성에 착륙하여 생명체의 흔적을 찾은 최초의 성공적인 미션입니다. 화성 표면의 고해상도 컬러 사진을 지구로 전송하여 화성의 황량한 풍경을 인류에게 처음으로 생생하게 전달했습니다.', 
            image: 'pic/viking_a.png', 
            specs: [{ label: 'STATUS', value: 'RETIRED' }, { label: 'LAUNCH', value: '1975.08.20' }, { label: 'LOC', value: 'MARS SURFACE' }], 
            gallery: ['pic/viking_1.png', 'pic/viking_2.png', 'pic/viking_3.png', 'pic/viking_4.png', 'pic/viking_5.png'] 
          },
          { 
            id: 'voyager', 
            index: '03', 
            name: 'Voyager 1', 
            year: '1977', 
            mission: 'The Grand Tour', 
            description: '목성, 토성, 천왕성, 해왕성을 모두 방문하며 인류의 시야를 태양계 끝까지 확장했습니다. 현재 태양권계면(Heliopause)을 넘어 성간 우주(Interstellar Space)를 항해 중인 인류 역사상 가장 멀리 떨어진 물체입니다.', 
            image: 'pic/voyager_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '1977.09.05' }, { label: 'LOC', value: 'INTERSTELLAR' }], 
            gallery: ['pic/voyager_1.png', 'pic/voyager_2.png', 'pic/voyager_3.png', 'pic/voyager_4.png', 'pic/voyager_5.png'] 
          },
          { 
            id: 'galileo', 
            index: '04', 
            name: 'Galileo', 
            year: '1989', 
            mission: 'Jupiter Orbiter', 
            description: '목성 궤도에 진입하여 장기간 머물며 목성의 대기와 위성들을 정밀 관측했습니다. 특히 유로파의 얼음 표면 아래 거대한 바다가 존재할 가능성을 제시하여 외계 생명체 탐사의 새로운 지평을 열었습니다.', 
            image: 'pic/galileo_a.png', 
            specs: [{ label: 'STATUS', value: 'DEORBITED' }, { label: 'LAUNCH', value: '1989.10.18' }, { label: 'LOC', value: 'JUPITER ORBIT' }], 
            gallery: ['pic/galileo_1.png', 'pic/galileo_2.png', 'pic/galileo_3.png', 'pic/galileo_4.png', 'pic/galileo_5.png'] 
          },
          { 
            id: 'hubble', 
            index: '05', 
            name: 'Hubble Telescope', 
            year: '1990', 
            mission: 'Deep Space Optics', 
            description: '지구 대기의 간섭을 피해 우주 궤도에 올려진 대형 광학 망원경입니다. 지난 30년이 넘는 시간 동안 우주의 나이를 측정하고 블랙홀의 존재를 확인하는 등 천문학 교과서를 다시 쓰게 만든 인류의 눈입니다.', 
            image: 'pic/hubble_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '1990.04.24' }, { label: 'LOC', value: 'LOW EARTH ORBIT' }], 
            gallery: ['pic/hubble_1.png', 'pic/hubble_2.png', 'pic/hubble_3.png', 'pic/hubble_4.png', 'pic/hubble_5.png'] 
          },
          { 
            id: 'spirit', 
            index: '06', 
            name: 'Spirit', 
            year: '2003', 
            mission: 'Mars Rover', 
            description: '화성 탐사 로버(MER) 프로젝트의 첫 번째 주자로, 구세브 분화구(Gusev Crater)에 착륙하여 물의 작용으로 형성된 광물을 찾아냈습니다. 2009년 모래 구덩이에 빠져 이동이 불가능해질 때까지 끈질기게 임무를 수행했습니다.', 
            image: 'pic/spirit_a.png', 
            specs: [{ label: 'STATUS', value: 'RETIRED' }, { label: 'LAUNCH', value: '2003.06.10' }, { label: 'LOC', value: 'GUSEV CRATER' }], 
            gallery: ['pic/spirit_1.png', 'pic/spirit_2.png', 'pic/spirit_3.png', 'pic/spirit_4.png', 'pic/spirit_5.png'] 
          },
          { 
            id: 'opportunity', 
            index: '07', 
            name: 'Opportunity', 
            year: '2003', 
            mission: 'Mars Rover', 
            description: '스피릿의 쌍둥이 로버로, 당초 예상 수명인 90일을 훌쩍 넘겨 무려 15년 가까이 화성 표면을 누비며 마라톤 거리보다 긴 거리를 주행했습니다. 화성의 과거에 물이 존재했다는 결정적인 지질학적 증거들을 발견했습니다.', 
            image: 'pic/opportunity_a.png', 
            specs: [{ label: 'STATUS', value: 'RETIRED' }, { label: 'LAUNCH', value: '2003.07.07' }, { label: 'LOC', value: 'MERIDIANI PLANUM' }], 
            gallery: ['pic/opportunity_1.png', 'pic/opportunity_2.png', 'pic/opportunity_3.png', 'pic/opportunity_4.png', 'pic/opportunity_5.png'] 
          },
          { 
            id: 'horizons', 
            index: '08', 
            name: 'New Horizons', 
            year: '2006', 
            mission: 'Pluto & Kuiper Belt', 
            description: '태양계의 변방인 명왕성을 탐사하기 위해 발사된 가장 빠른 탐사선 중 하나입니다. 2015년 명왕성에 근접하여 하트 모양의 평원을 발견했고, 이후 카이퍼 벨트의 소행성 아로코스(Arrokoth)를 근접 촬영하는 데 성공했습니다.', 
            image: 'pic/horizons_a.png', 
            specs: [{ label: 'STATUS', value: 'HIBERNATION' }, { label: 'LAUNCH', value: '2006.01.19' }, { label: 'LOC', value: 'KUIPER BELT' }], 
            gallery: ['pic/horizons_1.png', 'pic/horizons_2.png', 'pic/horizons_3.png', 'pic/horizons_4.png', 'pic/horizons_5.png'] 
          },
          { 
            id: 'curiosity', 
            index: '09', 
            name: 'Curiosity', 
            year: '2011', 
            mission: 'Mars Science Lab', 
            description: '화성 게일 분화구에 착륙한 1톤급의 대형 로버입니다. 화성이 과거에 미생물이 살 수 있는 환경이었는지를 조사하며, 암석에 구멍을 뚫어 성분을 분석하는 등 움직이는 과학 실험실로서 현재까지 활발히 활동 중입니다.', 
            image: 'pic/curiosity_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '2011.11.26' }, { label: 'LOC', value: 'GALE CRATER' }], 
            gallery: ['pic/curiosity_1.png', 'pic/curiosity_2.png', 'pic/curiosity_3.png', 'pic/curiosity_4.png', 'pic/curiosity_5.png'] 
          },
          { 
            id: 'parker', 
            index: '10', 
            name: 'Parker Solar Probe', 
            year: '2018', 
            mission: 'Touch the Sun', 
            description: '인류 역사상 태양에 가장 가까이 접근하는 탐사선입니다. 섭씨 1,000도가 넘는 고열과 방사선을 견디며 태양의 대기인 코로나 속을 비행하여 태양풍의 가속 원리와 코로나 가열의 비밀을 풀고 있습니다.', 
            image: 'pic/parker_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '2018.08.12' }, { label: 'LOC', value: 'SUN CORONA' }], 
            gallery: ['pic/parker_1.png', 'pic/parker_2.png', 'pic/parker_3.png', 'pic/parker_4.png', 'pic/parker_5.png'] 
          },
          { 
            id: 'perseverance', 
            index: '11', 
            name: 'Perseverance', 
            year: '2020', 
            mission: 'Mars 2020', 
            description: '큐리오시티를 기반으로 성능을 대폭 향상시킨 최신형 로버입니다. 고대 삼각주 지역인 예제로 분화구에서 미생물의 흔적을 찾고 있으며, 미래에 지구로 가져올 화성 토양 샘플을 채취하여 보관하는 중요한 임무를 수행 중입니다.', 
            image: 'pic/perseverance_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '2020.07.30' }, { label: 'LOC', value: 'JEZERO CRATER' }], 
            gallery: ['pic/perseverance_1.png', 'pic/perseverance_2.png', 'pic/perseverance_3.png', 'pic/perseverance_4.png', 'pic/perseverance_5.png'] 
          },
          { 
            id: 'jameswebb', 
            index: '12', 
            name: 'James Webb', 
            year: '2021', 
            mission: 'Infrared Astronomy', 
            description: '허블 우주 망원경의 뒤를 잇는 차세대 적외선 망원경입니다. 지구에서 약 150만 km 떨어진 라그랑주 점(L2)에 위치하여, 우주 탄생 초기의 빛과 외계 행성의 대기 성분을 분석하며 우주의 기원을 탐구하고 있습니다.', 
            image: 'pic/james_a.png', 
            specs: [{ label: 'STATUS', value: 'OPERATIONAL' }, { label: 'LAUNCH', value: '2021.12.25' }, { label: 'LOC', value: 'L2 POINT' }], 
            gallery: ['pic/james_1.png', 'pic/james_2.png', 'pic/james_3.png', 'pic/james_4.png', 'pic/james_5.png'] 
          },
          { 
            id: 'europa', 
            index: '13', 
            name: 'Europa Clipper', 
            year: '2024', 
            mission: 'Ocean World Explorer', 
            description: '목성의 위성 유로파를 정밀 탐사하기 위해 설계된 최신 탐사선입니다. 유로파의 두꺼운 얼음 껍질 아래 존재하는 지하 바다의 특성을 파악하고, 생명체가 서식할 수 있는 환경인지를 조사하기 위해 먼 여정을 떠났습니다.', 
            image: 'pic/europa_a.png', 
            specs: [{ label: 'STATUS', value: 'EN ROUTE' }, { label: 'LAUNCH', value: '2024.10.14' }, { label: 'LOC', value: 'EUROPA' }], 
            gallery: ['pic/europa_1.png', 'pic/europa_2.png', 'pic/europa_3.png', 'pic/europa_4.png', 'pic/europa_5.png'] 
          }
        ];

        const generateStars = (n) => {
            let value = `${Math.random() * 5000}px ${Math.random() * 5000}px #FFF`;
            for (let i = 2; i <= n; i++) value += `, ${Math.random() * 5000}px ${Math.random() * 5000}px #FFF`;
            return value;
        };

        const StarBackground = () => {
            const stars = useMemo(() => [generateStars(700), generateStars(200), generateStars(100)], []);
            return (
                <div className="fixed inset-0 z-0 pointer-events-none opacity-60">
                    <div style={{ width: '1px', height: '1px', boxShadow: stars[0], animation: 'animStar 150s linear infinite' }}></div>
                    <div style={{ width: '2px', height: '2px', boxShadow: stars[1], animation: 'animStar 300s linear infinite' }}></div>
                    <div style={{ width: '3px', height: '3px', boxShadow: stars[2], animation: 'animStar 450s linear infinite' }}></div>
                </div>
            );
        };

        const GlitchText = ({ text, isActive, speed = 40, className="" }) => {
            const [displayedText, setDisplayedText] = useState('');
            const [isGlitching, setIsGlitching] = useState(false);
            useEffect(() => {
                if (!isActive) { setDisplayedText(''); return; }
                setDisplayedText(''); setIsGlitching(true);
                let idx = 0;
                const interval = setInterval(() => {
                    if (idx <= text.length) { setDisplayedText(text.slice(0, idx)); idx++; } 
                    else { clearInterval(interval); setIsGlitching(false); }
                }, speed);
                return () => clearInterval(interval);
            }, [text, isActive]);
            return (
                <span className={`relative inline-block ${className} ${isGlitching ? 'text-orange-200' : ''}`}>
                    {displayedText}
                    {isGlitching && <span className="inline-block w-2 h-[1em] bg-orange-500 animate-pulse ml-1 align-middle"></span>}
                </span>
            );
        };

        // --- Helper for Status Color ---
        const getStatusColorClass = (val) => {
            const v = val.toUpperCase();
            if (v.includes('LOST') || v.includes('RETIRED') || v.includes('DISCONNECTED') || v.includes('DEORBITED')) {
                return 'text-red-500 animate-pulse font-bold drop-shadow-[0_0_8px_rgba(239,68,68,0.6)]';
            }
            if (v.includes('OPERATIONAL') || v.includes('STABLE') || v.includes('EN ROUTE')) {
                return 'text-emerald-400 font-bold drop-shadow-[0_0_8px_rgba(52,211,153,0.8)]';
            }
            if (v.includes('HIBERNATION')) {
                return 'text-yellow-400 font-bold';
            }
            return 'text-white';
        };

        const Hero = ({ onNext }) => {
            return (
                <section className="relative h-screen w-full flex flex-col justify-center items-center overflow-hidden z-10 pointer-events-none">
                    <div className="absolute top-auto bottom-[-50vh] left-1/2 -translate-x-1/2 w-[130vh] h-[130vh] rounded-full shadow-[0_0_120px_rgba(50,100,255,0.15)] bg-black border border-white/5 z-0 overflow-hidden">
                        <video src="vid/earth.mp4" autoPlay loop muted playsInline className="w-full h-full object-cover rounded-full rotate-45 opacity-70 scale-110 object-[50%_70%]"></video>
                    </div>
                    <div className="relative z-10 text-center -mt-32 w-full px-4">
                        <img src="pic/title.png" alt="Title" className="w-full max-w-4xl mx-auto h-auto object-contain drop-shadow-2xl mb-8" />
                        <p className="font-ui-sci text-orange-500 text-xs md:text-sm tracking-[0.5em] uppercase border-y border-white/10 py-2 mt-4 inline-block">Humanity's Great Journey</p>
                    </div>
                    <div className="absolute bottom-12 z-20 flex flex-col items-center gap-3 animate-pulse cursor-pointer pointer-events-auto group" onClick={onNext}>
                        <span className="text-[10px] font-terminal text-gray-500 group-hover:text-orange-400 transition-colors">INITIALIZE SCROLL</span>
                        <div className="w-px h-12 bg-gradient-to-b from-transparent via-gray-500 to-transparent group-hover:via-orange-500 transition-all"></div>
                    </div>
                </section>
            );
        };

        const Intro = ({ isActive }) => {
            const videoRef = useRef(null);
            useEffect(() => { if (isActive && videoRef.current) videoRef.current.play().catch(() => {}); }, [isActive]);

            return (
                <section className="h-screen w-full flex flex-col justify-center items-center relative p-8 z-10 pointer-events-none">
                    <div className={`relative w-full max-w-4xl h-[45vh] bg-black border border-white/10 overflow-hidden mb-12 transition-all duration-1000 ease-out ${isActive ? 'opacity-100 scale-100' : 'opacity-0 scale-90'}`}>
                        <video ref={videoRef} src="vid/vid1.mp4" muted autoPlay loop playsInline className="w-full h-full object-cover opacity-60 scale-105 grayscale contrast-125">
                            <div className="flex items-center justify-center w-full h-full text-gray-800 font-terminal text-xs">NO SIGNAL INPUT</div>
                        </video>
                        <div className="absolute top-4 left-4 flex gap-3 items-center">
                            <div className="w-1.5 h-1.5 bg-red-600 rounded-sm animate-pulse"></div>
                            <span className="text-[10px] font-terminal text-red-600 opacity-80">REC_MODE</span>
                        </div>
                        <div className="absolute inset-0 border border-white/5 pointer-events-none"></div>
                    </div>

                    <div className={`text-center space-y-8 max-w-2xl transition-all duration-1000 delay-300 ${isActive ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
                        <div className="flex flex-col items-center gap-2">
                            <span className="font-ui-sci text-orange-500 text-xs tracking-widest border border-orange-500/30 px-3 py-1 rounded-sm">SYSTEM BRIEFING</span>
                            <h2 className="text-3xl md:text-5xl font-header-sci text-white mt-2">DEEP SPACE<br/>ARCHIVE</h2>
                        </div>
                        <p className="text-base md:text-lg font-body-sci text-gray-400 font-light max-w-lg mx-auto">
                            지구나 다른 천체를 탐사하기 위해 우주로 쏘아 올린 무인 관측 도구.<br/>
                            <span className="text-gray-600 block mt-2 text-sm">인류가 직접 가기 어려운 극한의 우주 환경에서 임무를 수행합니다.</span>
                        </p>
                    </div>
                </section>
            );
        };

       const StoryGrid = ({ probeName, gallery }) => {
            const sectionRef = useRef(null);
            const [isVisible, setIsVisible] = useState(false);
            useEffect(() => {
                const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setIsVisible(true); }, { threshold: 0.1 });
                if (sectionRef.current) observer.observe(sectionRef.current);
                return () => observer.disconnect();
            }, [probeName]);
            useEffect(() => setIsVisible(false), [probeName]);

            if (!gallery) return null;
            return (
                <div 
                    ref={sectionRef} 
                    className={`
                        mt-24 relative z-[60] border-t border-white/10 bg-[#0B0C0E]/50 backdrop-blur-sm transition-all duration-700
                        w-full 
                        ${isVisible ? 'popup-card-visible opacity-100 translate-y-0' : 'opacity-0 translate-y-32'}
                    `}
                >
                    <div className="py-12 w-full max-w-[1600px] md:pr-12">
                        <div className="flex items-end justify-between mb-8 border-b border-white/10 pb-4">
                            <div>
                                {/* 삭제됨: / VISUAL_DATABASE 텍스트 */}
                                <h3 className="text-2xl font-header-sci text-white">MISSION LOGS</h3>
                            </div>
                            <span className="text-xs font-terminal text-gray-600 tracking-widest hidden md:block">REF_ID: {probeName.toUpperCase()}</span>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-1 auto-rows-[250px] md:auto-rows-[300px] border border-white/10 bg-white/5">
                            <div className="md:col-span-2 md:row-span-2 relative group overflow-hidden bg-black cursor-pointer">
                                <img src={gallery[0]} className="w-full h-full object-cover opacity-60 grayscale group-hover:grayscale-0 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700 ease-out" />
                                <div className="absolute top-4 left-4 z-20"><span className="bg-orange-600 text-black text-[10px] font-terminal px-2 py-0.5 font-bold">PRIMARY</span></div>
                            </div>
                            {gallery.slice(1, 4).map((img, i) => (
                                <div key={i} className="relative group overflow-hidden bg-black border-l border-b border-white/10 cursor-pointer">
                                    <img src={img} className="w-full h-full object-cover opacity-50 grayscale group-hover:grayscale-0 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700 ease-out" />
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const DetailContent = ({ probe, isActive }) => {
            return (
                <div className="w-full min-h-screen relative z-10 pb-24">
                    <div className="pl-4 pr-4 md:pl-64 md:pr-12 pt-20 max-w-[1800px] mx-auto flex flex-col justify-start">
                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 items-center min-h-[85vh] relative z-10">
                            
                            {/* Left Text Area */}
                            <div className="lg:col-span-5 space-y-8 order-2 lg:order-1 min-w-0 flex flex-col justify-center">
                                <div className="py-2">
                                    <h2 className="text-5xl md:text-7xl lg:text-8xl font-bold text-white leading-[0.85] font-header-sci tracking-tight mb-2 uppercase break-words">
                                        <GlitchText text={probe.name} isActive={isActive} speed={60} />
                                    </h2>
                                    <p className="text-sm md:text-base text-orange-500 font-ui-sci tracking-widest uppercase mt-4 flex items-center gap-3">
                                        {/* 삭제됨: 주황색 가로줄 */}
                                        {probe.mission}
                                    </p>
                                </div>
                                
                                <div className="font-body-sci text-gray-300 leading-relaxed text-base font-light md:pr-12">
                                    <GlitchText text={probe.description} isActive={isActive} speed={20} />
                                </div>

                                <div className="grid grid-cols-3 gap-4 pt-8 border-t border-white/10">
                                    {probe.specs.map((spec, i) => (
                                        <div key={i} className="flex flex-col gap-1">
                                            <span className="text-[10px] font-terminal text-gray-500 uppercase">{spec.label}</span>
                                            <span className={`text-sm md:text-lg font-terminal tracking-tighter ${spec.label === 'STATUS' ? getStatusColorClass(spec.value) : 'text-white'}`}>
                                                {spec.value}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Right Image Area */}
                            <div className="lg:col-span-7 relative h-[40vh] md:h-[60vh] lg:h-[80vh] w-full flex items-center justify-center order-1 lg:order-2 perspective-1000">
                                <div key={probe.id + isActive} className={`relative inline-block w-full h-full flex items-center justify-center ${isActive ? 'scan-active' : ''}`}>
                                    <div className="laser-beam"></div>
                                    <img src={probe.image} alt={probe.name} className="relative z-10 max-h-full max-w-full object-contain drop-shadow-[0_20px_60px_rgba(0,0,0,0.7)] scannable-image transition-transform duration-700 hover:scale-105" />
                                    
                                    <div className="absolute bottom-10 right-10 z-20 hidden md:block">
                                         <div className="font-terminal text-[10px] text-orange-500 text-right space-y-1">
                                            <p></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    
                         <StoryGrid probeName={probe.name} gallery={probe.gallery} />
                    </div>
                   
                </div>
            );
        };

        const NavBar = ({ activeId, onNavigate, isVisible, onBack }) => {
            const navScrollRef = useRef(null);
            const navTouchStart = useRef(null);

            const handleNavTouchStart = (e) => {
                navTouchStart.current = e.touches[0].clientY;
            };

            const handleNavTouchEnd = (e) => {
                if (!navTouchStart.current) return;
                const endY = e.changedTouches[0].clientY;
                const distance = navTouchStart.current - endY;
                const el = navScrollRef.current;
                
                if (el && el.scrollTop <= 0 && distance < -50) {
                    e.stopPropagation();
                    onBack(); 
                }
                navTouchStart.current = null;
            };

            return (
                <div className="fixed left-0 top-0 bottom-0 w-full md:w-auto md:left-0 z-40 pointer-events-none flex flex-col h-full">
                    <div className="relative flex-1 pointer-events-auto bg-black/95 md:bg-transparent backdrop-blur-md md:backdrop-blur-none md:pl-10 h-full overflow-hidden">
                        
                        <div className="absolute top-0 bottom-0 left-[38px] w-px bg-white/10 hidden md:block"></div>

                        <div 
                            ref={navScrollRef}
                            onTouchStart={handleNavTouchStart}
                            onTouchEnd={handleNavTouchEnd}
                            className="h-full overflow-y-auto custom-scrollbar md:pr-4 allow-scroll"
                        >
                            <div className="min-h-full flex flex-col justify-center gap-2 md:gap-5 p-8 md:p-0 py-20">
                                {probesData.map((probe, idx) => {
                                    const isActive = activeId === probe.id;
                                    return (
                                        <button key={probe.id} onClick={() => onNavigate(probe.id)} className="group relative flex items-center gap-3 w-full md:w-auto text-left flex-shrink-0">
                                            <span className={`font-terminal text-[9px] w-4 text-right transition-colors ${isActive ? 'text-orange-500' : 'text-gray-700 group-hover:text-gray-500'}`}>
                                                {probe.index}
                                            </span>
                                            <div className="relative w-3 h-3 flex items-center justify-center hidden md:flex flex-shrink-0">
                                                <div className={`w-1 h-1 rounded-sm bg-gray-800 transition-all duration-300 ${isActive ? 'bg-orange-500 scale-150' : 'group-hover:bg-white'}`}></div>
                                                {isActive && <div className="absolute inset-0 bg-orange-500/30 animate-ping rounded-sm"></div>}
                                            </div>
                                            <div className={`flex flex-col transition-all duration-300 ${isActive ? 'opacity-100 translate-x-1' : 'opacity-40 hover:opacity-100 hover:translate-x-0.5'}`}>
                                                <span className={`text-xl md:text-xs font-header-sci tracking-widest uppercase whitespace-nowrap ${isActive ? 'text-white' : 'text-gray-400'}`}>
                                                    {probe.name}
                                                </span>
                                            </div>
                                        </button>
                                    );
                                })}
                                <div className="md:hidden text-center mt-8 opacity-30">
                                    <p className="font-terminal text-[10px] text-gray-500">PULL DOWN TO RETURN</p>
                                    <div className="w-px h-8 bg-gray-700 mx-auto mt-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [viewPhase, setViewPhase] = useState(0); 
            const [activeProbeId, setActiveProbeId] = useState('pioneer');
            const [showMobileDetail, setShowMobileDetail] = useState(false); 
            const lastScrollTime = useRef(0);
            const scrollContainerRef = useRef(null);
            const touchStart = useRef(null);
            const [animState, setAnimState] = useState('slide-active');

            useEffect(() => {
                const handleWheel = (e) => {
                    if (viewPhase < 2) {
                        e.preventDefault(); 
                        const now = Date.now();
                        if (now - lastScrollTime.current < 1000) return;
                        lastScrollTime.current = now;
                        if (e.deltaY > 0) handlePhaseChange(viewPhase === 0 ? 1 : 2);
                        else if (e.deltaY < 0 && viewPhase === 1) handlePhaseChange(0);
                    }
                };
                const handleTouchStart = (e) => { touchStart.current = e.touches[0].clientY; };
                const handleTouchMove = (e) => { if (viewPhase < 2 && e.cancelable) e.preventDefault(); };
                const handleTouchEnd = (e) => {
                    if (!touchStart.current) return;
                    const endY = e.changedTouches[0].clientY;
                    const distance = touchStart.current - endY;
                    const now = Date.now();
                    if (now - lastScrollTime.current < 500) return;
                    if (Math.abs(distance) > 50) { 
                        lastScrollTime.current = now;
                        if (viewPhase === 0) { if (distance > 0) handlePhaseChange(1); }
                        else if (viewPhase === 1) { distance > 0 ? handlePhaseChange(2) : handlePhaseChange(0); }
                    }
                    touchStart.current = null;
                };
                window.addEventListener('wheel', handleWheel, { passive: false });
                window.addEventListener('touchstart', handleTouchStart, { passive: false });
                window.addEventListener('touchmove', handleTouchMove, { passive: false });
                window.addEventListener('touchend', handleTouchEnd, { passive: false });
                return () => {
                    window.removeEventListener('wheel', handleWheel);
                    window.removeEventListener('touchstart', handleTouchStart);
                    window.removeEventListener('touchmove', handleTouchMove);
                    window.removeEventListener('touchend', handleTouchEnd);
                };
            }, [viewPhase]); 

            const switchProbe = (nextId, direction) => {
                const now = Date.now();
                if (now - lastScrollTime.current < 800) return;
                lastScrollTime.current = now;
                if (direction === 'next') setAnimState('slide-up-out');
                else setAnimState('slide-down-out');
                setTimeout(() => {
                    setActiveProbeId(nextId);
                    if (scrollContainerRef.current) scrollContainerRef.current.scrollTop = 0;
                    if (direction === 'next') setAnimState('slide-up-in');
                    else setAnimState('slide-down-in');
                    requestAnimationFrame(() => { requestAnimationFrame(() => { setAnimState('slide-active'); }); });
                }, 500); 
            };

            const handlePhaseChange = (newPhase) => { setViewPhase(newPhase); };

            const handleDetailScroll = (e) => {
                if (viewPhase !== 2) return;
                const container = scrollContainerRef.current;
                if (!container || animState !== 'slide-active') return;
                const currentIndex = probesData.findIndex(p => p.id === activeProbeId);
                if (container.scrollTop === 0 && e.deltaY < 0) {
                    if (currentIndex === 0) handlePhaseChange(1); 
                    else switchProbe(probesData[currentIndex - 1].id, 'prev');
                } else if (container.scrollTop + container.clientHeight >= container.scrollHeight - 5 && e.deltaY > 0) {
                    if (currentIndex < probesData.length - 1) switchProbe(probesData[currentIndex + 1].id, 'next');
                }
            };

            const handleDetailTouchEnd = (e) => {
                if (viewPhase !== 2 || !touchStart.current) return;
                const endY = e.changedTouches[0].clientY;
                const distance = touchStart.current - endY;
                const container = scrollContainerRef.current;
                if (!container) return;
                if (distance < -50 && container.scrollTop === 0) {
                    const currentIndex = probesData.findIndex(p => p.id === activeProbeId);
                    currentIndex === 0 ? handlePhaseChange(1) : switchProbe(probesData[currentIndex - 1].id, 'prev');
                } else if (distance > 50 && container.scrollTop + container.clientHeight >= container.scrollHeight - 50) {
                    const currentIndex = probesData.findIndex(p => p.id === activeProbeId);
                    if (currentIndex < probesData.length - 1) switchProbe(probesData[currentIndex + 1].id, 'next');
                }
            };

            const handleNavigate = (id) => {
                setActiveProbeId(id);
                if (scrollContainerRef.current) scrollContainerRef.current.scrollTop = 0;
                setAnimState('slide-active'); 
                if (window.innerWidth < 768) setShowMobileDetail(true);
            };

            const activeProbe = probesData.find(p => p.id === activeProbeId);

            return (
                <div className="relative w-full h-screen overflow-hidden bg-[#0B0C0E]">
                    <StarBackground />
                    {viewPhase === 2 && showMobileDetail && (
                        <button onClick={() => setShowMobileDetail(false)} className="fixed top-6 right-6 z-[100] md:hidden px-4 py-2 bg-black/80 border border-orange-500 rounded-sm text-orange-500 font-terminal text-xs">⋯</button>
                    )}
                    <div className="w-full h-full page-transition relative z-10" style={{ transform: `translateY(-${viewPhase * 100}vh)` }}>
                        <div className="w-full h-screen relative"><Hero onNext={() => handlePhaseChange(1)} /></div>
                        <div className="w-full h-screen relative"><Intro isActive={viewPhase === 1} /></div>
                        <div className="w-full h-screen relative">
                            <div ref={scrollContainerRef} onWheel={handleDetailScroll} onTouchStart={(e) => { e.stopPropagation(); touchStart.current = e.touches[0].clientY; }} onTouchMove={(e) => e.stopPropagation()} onTouchEnd={(e) => { e.stopPropagation(); handleDetailTouchEnd(e); }} className={`w-full h-[100dvh] custom-scrollbar overflow-y-auto overflow-x-hidden allow-scroll ${(!showMobileDetail && 'hidden md:block')}`}>
                                <div className={`content-transition ${animState}`}><DetailContent probe={activeProbe} isActive={viewPhase === 2} /></div>
                            </div>
                        </div>
                    </div>
                    <div className={`transition-opacity duration-500 relative z-40 ${viewPhase === 2 ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
                        <div className={`${showMobileDetail ? 'hidden md:block' : 'block'}`}>
                            <NavBar activeId={activeProbeId} onNavigate={handleNavigate} isVisible={viewPhase === 2} onBack={() => handlePhaseChange(1)} />
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>